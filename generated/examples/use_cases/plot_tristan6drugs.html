
<!DOCTYPE html>


<html lang="en" data-content_root="../../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>The TRISTAN 6 compound study &#8212; dcmri 0.6.8 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/custom.css?v=cd8af66b" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../../_static/documentation_options.js?v=ac3b80e6"></script>
    <script src="../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../../_static/design-tabs.js?v=f930bc37"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'generated/examples/use_cases/plot_tristan6drugs';</script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Contribute" href="../../../contribute/index.html" />
    <link rel="prev" title="The TRISTAN experimental medicine study (2 scan protocol)" href="plot_tristan_volunteers_2scan.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../../_static/tristan-logo.jpg" class="logo__image only-light" alt="dcmri 0.6.8 documentation - Home"/>
    <script>document.write(`<img src="../../../_static/tristan-logo.jpg" class="logo__image only-dark" alt="dcmri 0.6.8 documentation - Home"/>`);</script>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../tutorial/index.html">
    Tutorial
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../reference/index.html">
    Reference
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../index.html">
    Examples
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../contribute/index.html">
    Contribute
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../releases/index.html">
    Releases
  </a>
</li>

            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-nav-more-links">
                    More
                </button>
                <ul id="pst-nav-more-links" class="dropdown-menu">
                    
<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../../../about/index.html">
    About
  </a>
</li>

                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/QIB-Sheffield/dcmri" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../tutorial/index.html">
    Tutorial
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../reference/index.html">
    Reference
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../index.html">
    Examples
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../contribute/index.html">
    Contribute
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../releases/index.html">
    Releases
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../about/index.html">
    About
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/QIB-Sheffield/dcmri" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../tutorials/index.html">Tutorials</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="index.html">Use cases</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="plot_tristan_volunteers.html">The TRISTAN experimental medicine study (1 scan protocol)</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_tristan_volunteers_2scan.html">The TRISTAN experimental medicine study (2 scan protocol)</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">The TRISTAN 6 compound study</a></li>
</ul>
</details></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../index.html" class="nav-link">Examples</a></li>
    
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">Use cases</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">The TRISTAN...</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-generated-examples-use-cases-plot-tristan6drugs-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code.</p>
</div>
<section class="sphx-glr-example-title" id="the-tristan-6-compound-study">
<span id="sphx-glr-generated-examples-use-cases-plot-tristan6drugs-py"></span><h1>The TRISTAN 6 compound study<a class="headerlink" href="#the-tristan-6-compound-study" title="Link to this heading">#</a></h1>
<p>This example illustrates the use of <a class="reference internal" href="../../api/dcmri.Liver.html#dcmri.Liver" title="dcmri.Liver"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Liver</span></code></a> for fitting of signals measured in liver. The use case is provided by the liver work package of the <a class="reference external" href="https://www.imi-tristan.eu/liver">TRISTAN project</a>  which develops imaging biomarkers for drug safety assessment. The data and analysis were first published in Melillo et al (2023).</p>
<p>The specific objective of the study was to determine the effect of selected drugs on hepatocellular uptake and excretion of the liver-specific contrast agent gadoxetate. If a drug inhibits uptake into liver cells, then it might cause other drugs to circulate in the blood stream for longer than expected, potentially causing harm to other organs. Alternatively, if a drug inhibits excretion from the liver, then it might cause other drugs to pool in liver cells for much longer than expected, potentially causing liver injury. These so-called drug-drug interactions (DDI’s) pose a significant risk to patients and trial participants. A direct in-vivo measurement of drug effects on liver uptake and excretion can potentially help improve predictions of DDI’s and inform dose setting strategies to reduce the risk.</p>
<p>The study presented here measured gadoxetate uptake and excretion in healthy rats before and after injection of 6 test drugs. Studies were performed in preclinical MRI scanners at 3 different centers and 2 different field strengths. Results demonstrated that two of the tested drugs (rifampicin and cyclosporine) showed strong inhibition of both uptake and excretion. One drug (ketoconazole) inhibited uptake but not excretion. Three drugs (pioglitazone, bosentan and asunaprevir) inhibited excretion but not uptake.</p>
<p><strong>Reference</strong></p>
<p>Melillo N, Scotcher D, Kenna JG, Green C, Hines CDG, Laitinen I, Hockings PD, Ogungbenro K, Gunwhy ER, Sourbron S, et al. Use of In Vivo Imaging and Physiologically-Based Kinetic Modelling to Predict Hepatic Transporter Mediated Drug–Drug Interactions in Rats. Pharmaceutics. 2023; 15(3):896. <a class="reference external" href="https://doi.org/10.3390/pharmaceutics15030896">[DOI]</a></p>
<section id="setup">
<h2>Setup<a class="headerlink" href="#setup" title="Link to this heading">#</a></h2>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import packages</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">dcmri</span> <span class="k">as</span> <span class="nn">dc</span>

<span class="c1"># Fetch the data</span>
<a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data</span></a> <span class="o">=</span> <span class="n">dc</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="s1">&#39;tristan6drugs&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="model-definition">
<h2>Model definition<a class="headerlink" href="#model-definition" title="Link to this heading">#</a></h2>
<p>In order to avoid some repetition in this script, we define a function that returns a trained model for a single dataset.</p>
<p>The model uses a standardized, population-average input function and fits for only 2 parameters, fixing all other free parameters to typical values for this rat model:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">tristan_rat</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data</span></a><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

    <span class="c1"># High-resolution time points for prediction</span>
    <span class="n">t</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.arange.html#numpy.arange" title="numpy.arange" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">arange</span></a><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.amax.html#numpy.amax" title="numpy.amax" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">amax</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data</span></a><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]),</span> <span class="mf">0.5</span><span class="p">)</span>

    <span class="c1"># Liver model with population input function</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">dc</span><span class="o">.</span><span class="n">Liver</span><span class="p">(</span>

        <span class="c1"># Input parameters</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">t</span><span class="p">,</span>
        <span class="n">ca</span> <span class="o">=</span> <span class="n">dc</span><span class="o">.</span><span class="n">aif_tristan_rat</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">BAT</span><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data</span></a><span class="p">[</span><span class="s1">&#39;BAT&#39;</span><span class="p">],</span> <span class="n">duration</span><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data</span></a><span class="p">[</span><span class="s1">&#39;duration&#39;</span><span class="p">]),</span>

        <span class="c1"># Acquisition parameters</span>
        <span class="n">field_strength</span> <span class="o">=</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data</span></a><span class="p">[</span><span class="s1">&#39;field_strength&#39;</span><span class="p">],</span>
        <span class="n">TR</span> <span class="o">=</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data</span></a><span class="p">[</span><span class="s1">&#39;TR&#39;</span><span class="p">],</span>
        <span class="n">FA</span> <span class="o">=</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data</span></a><span class="p">[</span><span class="s1">&#39;FA&#39;</span><span class="p">],</span>
        <span class="n">n0</span> <span class="o">=</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data</span></a><span class="p">[</span><span class="s1">&#39;n0&#39;</span><span class="p">],</span>

        <span class="c1"># Kinetic paramaters</span>
        <span class="n">kinetics</span> <span class="o">=</span> <span class="s1">&#39;IC-HF&#39;</span><span class="p">,</span>
        <span class="n">Hct</span> <span class="o">=</span> <span class="mf">0.418</span><span class="p">,</span>
        <span class="n">ve</span> <span class="o">=</span> <span class="mf">0.23</span><span class="p">,</span>
        <span class="n">free</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;khe&#39;</span><span class="p">,</span> <span class="s1">&#39;Th&#39;</span><span class="p">],</span>
        <span class="n">bounds</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">np</span><span class="o">.</span><span class="n">inf</span></a><span class="p">],</span>

        <span class="c1"># Tissue paramaters</span>
        <span class="n">R10</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">dc</span><span class="o">.</span><span class="n">T1</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data</span></a><span class="p">[</span><span class="s1">&#39;field_strength&#39;</span><span class="p">],</span> <span class="s1">&#39;liver&#39;</span><span class="p">),</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data</span></a><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">],</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data</span></a><span class="p">[</span><span class="s1">&#39;liver&#39;</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="check-model-fit">
<h2>Check model fit<a class="headerlink" href="#check-model-fit" title="Link to this heading">#</a></h2>
<p>Before running the full analysis on all cases, lets illustrate the results by fitting the baseline visit for the first subject. We use maximum verbosity to get some feedback about the iterations:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">tristan_rat</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data</span></a><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">xtol</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>   Iteration     Total nfev        Cost      Cost reduction    Step norm     Optimality
       0              1         3.7859e+01                                    7.79e+03
       1              3         2.4733e+01      1.31e+01       4.50e+02       1.41e+03
       2              5         2.0840e+01      3.89e+00       3.37e+02       9.02e+02
       3              6         1.3827e+01      7.01e+00       5.84e+02       2.96e+03
       4              7         5.7133e+00      8.11e+00       3.67e+01       3.14e+02
       5              8         3.7084e+00      2.00e+00       1.86e+02       1.14e+03
       6              9         2.3576e-01      3.47e+00       1.61e+01       1.08e+02
       7             10         1.9403e-01      4.17e-02       3.04e+00       1.85e-02
       8             11         1.9402e-01      3.26e-06       1.01e-01       8.99e-04
`xtol` termination condition is satisfied.
Function evaluations 11, initial cost 3.7859e+01, final cost 1.9402e-01, first-order optimality 8.99e-04.
</pre></div>
</div>
<p>Plot the results to check that the model has fitted the data:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data</span></a><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;time&#39;</span><span class="p">],</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data</span></a><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;liver&#39;</span><span class="p">])</span>
</pre></div>
</div>
<img src="../../../_images/sphx_glr_plot_tristan6drugs_001.png" srcset="../../../_images/sphx_glr_plot_tristan6drugs_001.png" alt="Prediction of the MRI signals., Reconstruction of concentrations." class = "sphx-glr-single-img"/><p>Print the measured model parameters and any derived parameters and check that standard deviations of measured parameters are small relative to the value, indicating that the parameters are measured reliably:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">print_params</span><span class="p">(</span><span class="n">round_to</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>-----------------------------------------
Free parameters with their errors (stdev)
-----------------------------------------
Hepatocellular uptake rate (khe): 0.029 (0.001) mL/sec/mL
Hepatocellular transit time (Th): 192.243 (4.826) sec
------------------
Derived parameters
------------------
Liver extracellular volume fraction (ve): 0.23 mL/mL
Biliary excretion rate (kbh): 0.004 mL/sec/mL
Hepatocellular tissue uptake rate (Khe): 0.127 mL/sec/mL
Biliary tissue excretion rate (Kbh): 0.005 mL/sec/mL
</pre></div>
</div>
</section>
<section id="fit-all-data">
<h2>Fit all data<a class="headerlink" href="#fit-all-data" title="Link to this heading">#</a></h2>
<p>Now that we have illustrated an individual result in some detail, we proceed with fitting all the data. Results are stored in a dataframe in long format:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># Loop over all datasets</span>
<span class="k">for</span> <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">scan</span></a> <span class="ow">in</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data</span></a><span class="p">:</span>

    <span class="c1"># Generate a trained model for scan i:</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">tristan_rat</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">scan</span></a><span class="p">,</span> <span class="n">xtol</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">)</span>

    <span class="c1"># Save fitted parameters as a dataframe.</span>
    <span class="n">pars</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">export_params</span><span class="p">()</span>
    <span class="n">pars</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span>
        <span class="n">orient</span> <span class="o">=</span> <span class="s1">&#39;index&#39;</span><span class="p">,</span>
        <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="s2">&quot;unit&quot;</span><span class="p">,</span> <span class="s1">&#39;stdev&#39;</span><span class="p">])</span>
    <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;parameter&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pars</span><span class="o">.</span><span class="n">index</span>
    <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;study&#39;</span><span class="p">]</span> <span class="o">=</span> <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">scan</span></a><span class="p">[</span><span class="s1">&#39;study&#39;</span><span class="p">]</span>
    <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;visit&#39;</span><span class="p">]</span> <span class="o">=</span> <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">scan</span></a><span class="p">[</span><span class="s1">&#39;visit&#39;</span><span class="p">]</span>
    <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;subject&#39;</span><span class="p">]</span> <span class="o">=</span> <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">scan</span></a><span class="p">[</span><span class="s1">&#39;subject&#39;</span><span class="p">]</span>

    <span class="c1"># Add the dataframe to the list of results</span>
    <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pars</span><span class="p">)</span>

<span class="c1"># Combine all results into a single dataframe.</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">results</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Print all results</span>
<span class="nb">print</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">to_string</span><span class="p">())</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>                                    name        value       unit       stdev parameter  study  visit  subject
0    Liver extracellular volume fraction     0.230000      mL/mL    0.000000        ve      5      1        2
1             Hepatocellular uptake rate     0.029190  mL/sec/mL    0.000688       khe      5      1        2
2            Hepatocellular transit time   192.243231        sec    4.826217        Th      5      1        2
3                 Biliary excretion rate     0.004005  mL/sec/mL    0.000000       kbh      5      1        2
4      Hepatocellular tissue uptake rate     0.126913  mL/sec/mL    0.000000       Khe      5      1        2
5          Biliary tissue excretion rate     0.005202  mL/sec/mL    0.000000       Kbh      5      1        2
6    Liver extracellular volume fraction     0.230000      mL/mL    0.000000        ve      5      2        2
7             Hepatocellular uptake rate     0.017054  mL/sec/mL    0.000897       khe      5      2        2
8            Hepatocellular transit time   316.545195        sec   19.001555        Th      5      2        2
9                 Biliary excretion rate     0.002433  mL/sec/mL    0.000000       kbh      5      2        2
10     Hepatocellular tissue uptake rate     0.074147  mL/sec/mL    0.000000       Khe      5      2        2
11         Biliary tissue excretion rate     0.003159  mL/sec/mL    0.000000       Kbh      5      2        2
12   Liver extracellular volume fraction     0.230000      mL/mL    0.000000        ve      5      1        3
13            Hepatocellular uptake rate     0.023124  mL/sec/mL    0.002277       khe      5      1        3
14           Hepatocellular transit time   154.451823        sec   16.263365        Th      5      1        3
15                Biliary excretion rate     0.004985  mL/sec/mL    0.000000       kbh      5      1        3
16     Hepatocellular tissue uptake rate     0.100538  mL/sec/mL    0.000000       Khe      5      1        3
17         Biliary tissue excretion rate     0.006475  mL/sec/mL    0.000000       Kbh      5      1        3
18   Liver extracellular volume fraction     0.230000      mL/mL    0.000000        ve      5      2        3
19            Hepatocellular uptake rate     0.010411  mL/sec/mL    0.000680       khe      5      2        3
20           Hepatocellular transit time   385.247200        sec   30.369628        Th      5      2        3
21                Biliary excretion rate     0.001999  mL/sec/mL    0.000000       kbh      5      2        3
22     Hepatocellular tissue uptake rate     0.045266  mL/sec/mL    0.000000       Khe      5      2        3
23         Biliary tissue excretion rate     0.002596  mL/sec/mL    0.000000       Kbh      5      2        3
24   Liver extracellular volume fraction     0.230000      mL/mL    0.000000        ve      5      1        4
25            Hepatocellular uptake rate     0.017875  mL/sec/mL    0.000786       khe      5      1        4
26           Hepatocellular transit time   185.341891        sec    8.849742        Th      5      1        4
27                Biliary excretion rate     0.004154  mL/sec/mL    0.000000       kbh      5      1        4
28     Hepatocellular tissue uptake rate     0.077715  mL/sec/mL    0.000000       Khe      5      1        4
29         Biliary tissue excretion rate     0.005395  mL/sec/mL    0.000000       Kbh      5      1        4
30   Liver extracellular volume fraction     0.230000      mL/mL    0.000000        ve      5      2        4
31            Hepatocellular uptake rate     0.015200  mL/sec/mL    0.000948       khe      5      2        4
32           Hepatocellular transit time   205.809785        sec   14.080504        Th      5      2        4
33                Biliary excretion rate     0.003741  mL/sec/mL    0.000000       kbh      5      2        4
34     Hepatocellular tissue uptake rate     0.066086  mL/sec/mL    0.000000       Khe      5      2        4
35         Biliary tissue excretion rate     0.004859  mL/sec/mL    0.000000       Kbh      5      2        4
36   Liver extracellular volume fraction     0.230000      mL/mL    0.000000        ve      5      1        5
37            Hepatocellular uptake rate     0.015750  mL/sec/mL    0.001191       khe      5      1        5
38           Hepatocellular transit time   194.629011        sec   16.068673        Th      5      1        5
39                Biliary excretion rate     0.003956  mL/sec/mL    0.000000       kbh      5      1        5
40     Hepatocellular tissue uptake rate     0.068477  mL/sec/mL    0.000000       Khe      5      1        5
41         Biliary tissue excretion rate     0.005138  mL/sec/mL    0.000000       Kbh      5      1        5
42   Liver extracellular volume fraction     0.230000      mL/mL    0.000000        ve      5      2        5
43            Hepatocellular uptake rate     0.014848  mL/sec/mL    0.000685       khe      5      2        5
44           Hepatocellular transit time   257.640511        sec   13.274273        Th      5      2        5
45                Biliary excretion rate     0.002989  mL/sec/mL    0.000000       kbh      5      2        5
46     Hepatocellular tissue uptake rate     0.064557  mL/sec/mL    0.000000       Khe      5      2        5
47         Biliary tissue excretion rate     0.003881  mL/sec/mL    0.000000       Kbh      5      2        5
48   Liver extracellular volume fraction     0.230000      mL/mL    0.000000        ve      5      1        6
49            Hepatocellular uptake rate     0.017683  mL/sec/mL    0.001339       khe      5      1        6
50           Hepatocellular transit time   171.889101        sec   14.093554        Th      5      1        6
51                Biliary excretion rate     0.004480  mL/sec/mL    0.000000       kbh      5      1        6
52     Hepatocellular tissue uptake rate     0.076884  mL/sec/mL    0.000000       Khe      5      1        6
53         Biliary tissue excretion rate     0.005818  mL/sec/mL    0.000000       Kbh      5      1        6
54   Liver extracellular volume fraction     0.230000      mL/mL    0.000000        ve      5      2        6
55            Hepatocellular uptake rate     0.019303  mL/sec/mL    0.001362       khe      5      2        6
56           Hepatocellular transit time   208.107768        sec   15.979978        Th      5      2        6
57                Biliary excretion rate     0.003700  mL/sec/mL    0.000000       kbh      5      2        6
58     Hepatocellular tissue uptake rate     0.083928  mL/sec/mL    0.000000       Khe      5      2        6
59         Biliary tissue excretion rate     0.004805  mL/sec/mL    0.000000       Kbh      5      2        6
60   Liver extracellular volume fraction     0.230000      mL/mL    0.000000        ve     10      1        1
61            Hepatocellular uptake rate     0.032653  mL/sec/mL    0.002456       khe     10      1        1
62           Hepatocellular transit time   204.091946        sec   16.284380        Th     10      1        1
63                Biliary excretion rate     0.003773  mL/sec/mL    0.000000       kbh     10      1        1
64     Hepatocellular tissue uptake rate     0.141971  mL/sec/mL    0.000000       Khe     10      1        1
65         Biliary tissue excretion rate     0.004900  mL/sec/mL    0.000000       Kbh     10      1        1
66   Liver extracellular volume fraction     0.230000      mL/mL    0.000000        ve     10      2        1
67            Hepatocellular uptake rate     0.010368  mL/sec/mL    0.000343       khe     10      2        1
68           Hepatocellular transit time   409.167245        sec   16.615195        Th     10      2        1
69                Biliary excretion rate     0.001882  mL/sec/mL    0.000000       kbh     10      2        1
70     Hepatocellular tissue uptake rate     0.045079  mL/sec/mL    0.000000       Khe     10      2        1
71         Biliary tissue excretion rate     0.002444  mL/sec/mL    0.000000       Kbh     10      2        1
72   Liver extracellular volume fraction     0.230000      mL/mL    0.000000        ve     10      1        2
73            Hepatocellular uptake rate     0.025971  mL/sec/mL    0.001774       khe     10      1        2
74           Hepatocellular transit time   260.957880        sec   19.472152        Th     10      1        2
75                Biliary excretion rate     0.002951  mL/sec/mL    0.000000       kbh     10      1        2
76     Hepatocellular tissue uptake rate     0.112919  mL/sec/mL    0.000000       Khe     10      1        2
77         Biliary tissue excretion rate     0.003832  mL/sec/mL    0.000000       Kbh     10      1        2
78   Liver extracellular volume fraction     0.230000      mL/mL    0.000000        ve     10      2        2
79            Hepatocellular uptake rate     0.027057  mL/sec/mL    0.001880       khe     10      2        2
80           Hepatocellular transit time   345.726528        sec   27.298622        Th     10      2        2
81                Biliary excretion rate     0.002227  mL/sec/mL    0.000000       kbh     10      2        2
82     Hepatocellular tissue uptake rate     0.117637  mL/sec/mL    0.000000       Khe     10      2        2
83         Biliary tissue excretion rate     0.002892  mL/sec/mL    0.000000       Kbh     10      2        2
84   Liver extracellular volume fraction     0.230000      mL/mL    0.000000        ve     10      1        3
85            Hepatocellular uptake rate     0.036773  mL/sec/mL    0.002990       khe     10      1        3
86           Hepatocellular transit time   192.090744        sec   16.411674        Th     10      1        3
87                Biliary excretion rate     0.004009  mL/sec/mL    0.000000       kbh     10      1        3
88     Hepatocellular tissue uptake rate     0.159882  mL/sec/mL    0.000000       Khe     10      1        3
89         Biliary tissue excretion rate     0.005206  mL/sec/mL    0.000000       Kbh     10      1        3
90   Liver extracellular volume fraction     0.230000      mL/mL    0.000000        ve     10      2        3
91            Hepatocellular uptake rate     0.033379  mL/sec/mL    0.001950       khe     10      2        3
92           Hepatocellular transit time   253.676402        sec   15.913505        Th     10      2        3
93                Biliary excretion rate     0.003035  mL/sec/mL    0.000000       kbh     10      2        3
94     Hepatocellular tissue uptake rate     0.145126  mL/sec/mL    0.000000       Khe     10      2        3
95         Biliary tissue excretion rate     0.003942  mL/sec/mL    0.000000       Kbh     10      2        3
96   Liver extracellular volume fraction     0.230000      mL/mL    0.000000        ve     10      1        4
97            Hepatocellular uptake rate     0.034564  mL/sec/mL    0.003412       khe     10      1        4
98           Hepatocellular transit time   221.215145        sec   23.174577        Th     10      1        4
99                Biliary excretion rate     0.003481  mL/sec/mL    0.000000       kbh     10      1        4
100    Hepatocellular tissue uptake rate     0.150278  mL/sec/mL    0.000000       Khe     10      1        4
101        Biliary tissue excretion rate     0.004520  mL/sec/mL    0.000000       Kbh     10      1        4
102  Liver extracellular volume fraction     0.230000      mL/mL    0.000000        ve     10      2        4
103           Hepatocellular uptake rate     0.027511  mL/sec/mL    0.001588       khe     10      2        4
104          Hepatocellular transit time   248.818781        sec   15.572969        Th     10      2        4
105               Biliary excretion rate     0.003095  mL/sec/mL    0.000000       kbh     10      2        4
106    Hepatocellular tissue uptake rate     0.119612  mL/sec/mL    0.000000       Khe     10      2        4
107        Biliary tissue excretion rate     0.004019  mL/sec/mL    0.000000       Kbh     10      2        4
108  Liver extracellular volume fraction     0.230000      mL/mL    0.000000        ve     10      1        5
109           Hepatocellular uptake rate     0.032725  mL/sec/mL    0.002461       khe     10      1        5
110          Hepatocellular transit time   203.317166        sec   16.211089        Th     10      1        5
111               Biliary excretion rate     0.003787  mL/sec/mL    0.000000       kbh     10      1        5
112    Hepatocellular tissue uptake rate     0.142282  mL/sec/mL    0.000000       Khe     10      1        5
113        Biliary tissue excretion rate     0.004918  mL/sec/mL    0.000000       Kbh     10      1        5
114  Liver extracellular volume fraction     0.230000      mL/mL    0.000000        ve     10      2        5
115           Hepatocellular uptake rate     0.034150  mL/sec/mL    0.002112       khe     10      2        5
116          Hepatocellular transit time   256.899838        sec   17.054504        Th     10      2        5
117               Biliary excretion rate     0.002997  mL/sec/mL    0.000000       kbh     10      2        5
118    Hepatocellular tissue uptake rate     0.148479  mL/sec/mL    0.000000       Khe     10      2        5
119        Biliary tissue excretion rate     0.003893  mL/sec/mL    0.000000       Kbh     10      2        5
120  Liver extracellular volume fraction     0.230000      mL/mL    0.000000        ve     10      1        6
121           Hepatocellular uptake rate     0.039968  mL/sec/mL    0.002835       khe     10      1        6
122          Hepatocellular transit time   225.368526        sec   16.822670        Th     10      1        6
123               Biliary excretion rate     0.003417  mL/sec/mL    0.000000       kbh     10      1        6
124    Hepatocellular tissue uptake rate     0.173772  mL/sec/mL    0.000000       Khe     10      1        6
125        Biliary tissue excretion rate     0.004437  mL/sec/mL    0.000000       Kbh     10      1        6
126  Liver extracellular volume fraction     0.230000      mL/mL    0.000000        ve     10      2        6
127           Hepatocellular uptake rate     0.036885  mL/sec/mL    0.002696       khe     10      2        6
128          Hepatocellular transit time   268.180191        sec   21.019359        Th     10      2        6
129               Biliary excretion rate     0.002871  mL/sec/mL    0.000000       kbh     10      2        6
130    Hepatocellular tissue uptake rate     0.160368  mL/sec/mL    0.000000       Khe     10      2        6
131        Biliary tissue excretion rate     0.003729  mL/sec/mL    0.000000       Kbh     10      2        6
132  Liver extracellular volume fraction     0.230000      mL/mL    0.000000        ve      9      1        1
133           Hepatocellular uptake rate     0.020031  mL/sec/mL    0.000708       khe      9      1        1
134          Hepatocellular transit time   373.932721        sec   15.519362        Th      9      1        1
135               Biliary excretion rate     0.002059  mL/sec/mL    0.000000       kbh      9      1        1
136    Hepatocellular tissue uptake rate     0.087089  mL/sec/mL    0.000000       Khe      9      1        1
137        Biliary tissue excretion rate     0.002674  mL/sec/mL    0.000000       Kbh      9      1        1
138  Liver extracellular volume fraction     0.230000      mL/mL    0.000000        ve      9      2        1
139           Hepatocellular uptake rate     0.019135  mL/sec/mL    0.000889       khe      9      2        1
140          Hepatocellular transit time   331.534809        sec   17.641786        Th      9      2        1
141               Biliary excretion rate     0.002323  mL/sec/mL    0.000000       kbh      9      2        1
142    Hepatocellular tissue uptake rate     0.083198  mL/sec/mL    0.000000       Khe      9      2        1
143        Biliary tissue excretion rate     0.003016  mL/sec/mL    0.000000       Kbh      9      2        1
144  Liver extracellular volume fraction     0.230000      mL/mL    0.000000        ve      9      1        2
145           Hepatocellular uptake rate     0.017120  mL/sec/mL    0.001284       khe      9      1        2
146          Hepatocellular transit time   231.514839        sec   19.113098        Th      9      1        2
147               Biliary excretion rate     0.003326  mL/sec/mL    0.000000       kbh      9      1        2
148    Hepatocellular tissue uptake rate     0.074434  mL/sec/mL    0.000000       Khe      9      1        2
149        Biliary tissue excretion rate     0.004319  mL/sec/mL    0.000000       Kbh      9      1        2
150  Liver extracellular volume fraction     0.230000      mL/mL    0.000000        ve      9      2        2
151           Hepatocellular uptake rate     0.022701  mL/sec/mL    0.001489       khe      9      2        2
152          Hepatocellular transit time   326.264422        sec   24.257552        Th      9      2        2
153               Biliary excretion rate     0.002360  mL/sec/mL    0.000000       kbh      9      2        2
154    Hepatocellular tissue uptake rate     0.098699  mL/sec/mL    0.000000       Khe      9      2        2
155        Biliary tissue excretion rate     0.003065  mL/sec/mL    0.000000       Kbh      9      2        2
156  Liver extracellular volume fraction     0.230000      mL/mL    0.000000        ve      9      1        3
157           Hepatocellular uptake rate     0.028307  mL/sec/mL    0.002241       khe      9      1        3
158          Hepatocellular transit time   297.424759        sec   25.999685        Th      9      1        3
159               Biliary excretion rate     0.002589  mL/sec/mL    0.000000       kbh      9      1        3
160    Hepatocellular tissue uptake rate     0.123075  mL/sec/mL    0.000000       Khe      9      1        3
161        Biliary tissue excretion rate     0.003362  mL/sec/mL    0.000000       Kbh      9      1        3
162  Liver extracellular volume fraction     0.230000      mL/mL    0.000000        ve      9      2        3
163           Hepatocellular uptake rate     0.025217  mL/sec/mL    0.001576       khe      9      2        3
164          Hepatocellular transit time   327.676944        sec   23.124073        Th      9      2        3
165               Biliary excretion rate     0.002350  mL/sec/mL    0.000000       kbh      9      2        3
166    Hepatocellular tissue uptake rate     0.109638  mL/sec/mL    0.000000       Khe      9      2        3
167        Biliary tissue excretion rate     0.003052  mL/sec/mL    0.000000       Kbh      9      2        3
168  Liver extracellular volume fraction     0.230000      mL/mL    0.000000        ve      8      1        1
169           Hepatocellular uptake rate     0.029345  mL/sec/mL    0.001968       khe      8      1        1
170          Hepatocellular transit time   408.239025        sec   31.802599        Th      8      1        1
171               Biliary excretion rate     0.001886  mL/sec/mL    0.000000       kbh      8      1        1
172    Hepatocellular tissue uptake rate     0.127589  mL/sec/mL    0.000000       Khe      8      1        1
173        Biliary tissue excretion rate     0.002450  mL/sec/mL    0.000000       Kbh      8      1        1
174  Liver extracellular volume fraction     0.230000      mL/mL    0.000000        ve      8      2        1
175           Hepatocellular uptake rate     0.003034  mL/sec/mL    0.000465       khe      8      2        1
176          Hepatocellular transit time   849.985157        sec  226.634084        Th      8      2        1
177               Biliary excretion rate     0.000906  mL/sec/mL    0.000000       kbh      8      2        1
178    Hepatocellular tissue uptake rate     0.013192  mL/sec/mL    0.000000       Khe      8      2        1
179        Biliary tissue excretion rate     0.001176  mL/sec/mL    0.000000       Kbh      8      2        1
180  Liver extracellular volume fraction     0.230000      mL/mL    0.000000        ve      8      1        2
181           Hepatocellular uptake rate     0.027850  mL/sec/mL    0.002512       khe      8      1        2
182          Hepatocellular transit time   269.040751        sec   26.101762        Th      8      1        2
183               Biliary excretion rate     0.002862  mL/sec/mL    0.000000       kbh      8      1        2
184    Hepatocellular tissue uptake rate     0.121085  mL/sec/mL    0.000000       Khe      8      1        2
185        Biliary tissue excretion rate     0.003717  mL/sec/mL    0.000000       Kbh      8      1        2
186  Liver extracellular volume fraction     0.230000      mL/mL    0.000000        ve      8      2        2
187           Hepatocellular uptake rate     0.003094  mL/sec/mL    0.000566       khe      8      2        2
188          Hepatocellular transit time   742.046879        sec  217.734795        Th      8      2        2
189               Biliary excretion rate     0.001038  mL/sec/mL    0.000000       kbh      8      2        2
190    Hepatocellular tissue uptake rate     0.013450  mL/sec/mL    0.000000       Khe      8      2        2
191        Biliary tissue excretion rate     0.001348  mL/sec/mL    0.000000       Kbh      8      2        2
192  Liver extracellular volume fraction     0.230000      mL/mL    0.000000        ve      8      1        3
193           Hepatocellular uptake rate     0.019729  mL/sec/mL    0.001369       khe      8      1        3
194          Hepatocellular transit time   383.855392        sec   31.115480        Th      8      1        3
195               Biliary excretion rate     0.002006  mL/sec/mL    0.000000       kbh      8      1        3
196    Hepatocellular tissue uptake rate     0.085777  mL/sec/mL    0.000000       Khe      8      1        3
197        Biliary tissue excretion rate     0.002605  mL/sec/mL    0.000000       Kbh      8      1        3
198  Liver extracellular volume fraction     0.230000      mL/mL    0.000000        ve      8      2        3
199           Hepatocellular uptake rate     0.002214  mL/sec/mL    0.000385       khe      8      2        3
200          Hepatocellular transit time  1076.657103        sec  381.093001        Th      8      2        3
201               Biliary excretion rate     0.000715  mL/sec/mL    0.000000       kbh      8      2        3
202    Hepatocellular tissue uptake rate     0.009627  mL/sec/mL    0.000000       Khe      8      2        3
203        Biliary tissue excretion rate     0.000929  mL/sec/mL    0.000000       Kbh      8      2        3
204  Liver extracellular volume fraction     0.230000      mL/mL    0.000000        ve      8      1        4
205           Hepatocellular uptake rate     0.018833  mL/sec/mL    0.001175       khe      8      1        4
206          Hepatocellular transit time   435.350405        sec   33.000430        Th      8      1        4
207               Biliary excretion rate     0.001769  mL/sec/mL    0.000000       kbh      8      1        4
208    Hepatocellular tissue uptake rate     0.081882  mL/sec/mL    0.000000       Khe      8      1        4
209        Biliary tissue excretion rate     0.002297  mL/sec/mL    0.000000       Kbh      8      1        4
210  Liver extracellular volume fraction     0.230000      mL/mL    0.000000        ve      8      2        4
211           Hepatocellular uptake rate     0.002796  mL/sec/mL    0.000412       khe      8      2        4
212          Hepatocellular transit time   759.089184        sec  181.626538        Th      8      2        4
213               Biliary excretion rate     0.001014  mL/sec/mL    0.000000       kbh      8      2        4
214    Hepatocellular tissue uptake rate     0.012158  mL/sec/mL    0.000000       Khe      8      2        4
215        Biliary tissue excretion rate     0.001317  mL/sec/mL    0.000000       Kbh      8      2        4
216  Liver extracellular volume fraction     0.230000      mL/mL    0.000000        ve      8      1        5
217           Hepatocellular uptake rate     0.025961  mL/sec/mL    0.002108       khe      8      1        5
218          Hepatocellular transit time   262.085769        sec   22.928833        Th      8      1        5
219               Biliary excretion rate     0.002938  mL/sec/mL    0.000000       kbh      8      1        5
220    Hepatocellular tissue uptake rate     0.112876  mL/sec/mL    0.000000       Khe      8      1        5
221        Biliary tissue excretion rate     0.003816  mL/sec/mL    0.000000       Kbh      8      1        5
222  Liver extracellular volume fraction     0.230000      mL/mL    0.000000        ve      8      2        5
223           Hepatocellular uptake rate     0.002245  mL/sec/mL    0.000342       khe      8      2        5
224          Hepatocellular transit time   958.744458        sec  274.919562        Th      8      2        5
225               Biliary excretion rate     0.000803  mL/sec/mL    0.000000       kbh      8      2        5
226    Hepatocellular tissue uptake rate     0.009760  mL/sec/mL    0.000000       Khe      8      2        5
227        Biliary tissue excretion rate     0.001043  mL/sec/mL    0.000000       Kbh      8      2        5
228  Liver extracellular volume fraction     0.230000      mL/mL    0.000000        ve      8      1        6
229           Hepatocellular uptake rate     0.025441  mL/sec/mL    0.002051       khe      8      1        6
230          Hepatocellular transit time   295.227592        sec   26.035385        Th      8      1        6
231               Biliary excretion rate     0.002608  mL/sec/mL    0.000000       kbh      8      1        6
232    Hepatocellular tissue uptake rate     0.110615  mL/sec/mL    0.000000       Khe      8      1        6
233        Biliary tissue excretion rate     0.003387  mL/sec/mL    0.000000       Kbh      8      1        6
234  Liver extracellular volume fraction     0.230000      mL/mL    0.000000        ve      8      2        6
235           Hepatocellular uptake rate     0.001989  mL/sec/mL    0.000368       khe      8      2        6
236          Hepatocellular transit time  1046.429137        sec  386.425115        Th      8      2        6
237               Biliary excretion rate     0.000736  mL/sec/mL    0.000000       kbh      8      2        6
238    Hepatocellular tissue uptake rate     0.008648  mL/sec/mL    0.000000       Khe      8      2        6
239        Biliary tissue excretion rate     0.000956  mL/sec/mL    0.000000       Kbh      8      2        6
240  Liver extracellular volume fraction     0.230000      mL/mL    0.000000        ve      7      1        2
241           Hepatocellular uptake rate     0.022071  mL/sec/mL    0.002018       khe      7      1        2
242          Hepatocellular transit time   293.495357        sec   29.622858        Th      7      1        2
243               Biliary excretion rate     0.002624  mL/sec/mL    0.000000       kbh      7      1        2
244    Hepatocellular tissue uptake rate     0.095960  mL/sec/mL    0.000000       Khe      7      1        2
245        Biliary tissue excretion rate     0.003407  mL/sec/mL    0.000000       Kbh      7      1        2
246  Liver extracellular volume fraction     0.230000      mL/mL    0.000000        ve      7      2        2
247           Hepatocellular uptake rate     0.012011  mL/sec/mL    0.001000       khe      7      2        2
248          Hepatocellular transit time   260.765420        sec   24.244886        Th      7      2        2
249               Biliary excretion rate     0.002953  mL/sec/mL    0.000000       kbh      7      2        2
250    Hepatocellular tissue uptake rate     0.052224  mL/sec/mL    0.000000       Khe      7      2        2
251        Biliary tissue excretion rate     0.003835  mL/sec/mL    0.000000       Kbh      7      2        2
252  Liver extracellular volume fraction     0.230000      mL/mL    0.000000        ve      7      1        3
253           Hepatocellular uptake rate     0.020564  mL/sec/mL    0.002026       khe      7      1        3
254          Hepatocellular transit time   282.347231        sec   30.657906        Th      7      1        3
255               Biliary excretion rate     0.002727  mL/sec/mL    0.000000       kbh      7      1        3
256    Hepatocellular tissue uptake rate     0.089411  mL/sec/mL    0.000000       Khe      7      1        3
257        Biliary tissue excretion rate     0.003542  mL/sec/mL    0.000000       Kbh      7      1        3
258  Liver extracellular volume fraction     0.230000      mL/mL    0.000000        ve      7      2        3
259           Hepatocellular uptake rate     0.014716  mL/sec/mL    0.001504       khe      7      2        3
260          Hepatocellular transit time   263.632479        sec   29.902765        Th      7      2        3
261               Biliary excretion rate     0.002921  mL/sec/mL    0.000000       kbh      7      2        3
262    Hepatocellular tissue uptake rate     0.063982  mL/sec/mL    0.000000       Khe      7      2        3
263        Biliary tissue excretion rate     0.003793  mL/sec/mL    0.000000       Kbh      7      2        3
264  Liver extracellular volume fraction     0.230000      mL/mL    0.000000        ve      7      1        4
265           Hepatocellular uptake rate     0.013127  mL/sec/mL    0.000953       khe      7      1        4
266          Hepatocellular transit time   298.408185        sec   24.533385        Th      7      1        4
267               Biliary excretion rate     0.002580  mL/sec/mL    0.000000       kbh      7      1        4
268    Hepatocellular tissue uptake rate     0.057075  mL/sec/mL    0.000000       Khe      7      1        4
269        Biliary tissue excretion rate     0.003351  mL/sec/mL    0.000000       Kbh      7      1        4
270  Liver extracellular volume fraction     0.230000      mL/mL    0.000000        ve      7      2        4
271           Hepatocellular uptake rate     0.005471  mL/sec/mL    0.000503       khe      7      2        4
272          Hepatocellular transit time   360.844015        sec   39.768992        Th      7      2        4
273               Biliary excretion rate     0.002134  mL/sec/mL    0.000000       kbh      7      2        4
274    Hepatocellular tissue uptake rate     0.023789  mL/sec/mL    0.000000       Khe      7      2        4
275        Biliary tissue excretion rate     0.002771  mL/sec/mL    0.000000       Kbh      7      2        4
276  Liver extracellular volume fraction     0.230000      mL/mL    0.000000        ve      7      1        5
277           Hepatocellular uptake rate     0.020795  mL/sec/mL    0.002349       khe      7      1        5
278          Hepatocellular transit time   217.739731        sec   26.492120        Th      7      1        5
279               Biliary excretion rate     0.003536  mL/sec/mL    0.000000       kbh      7      1        5
280    Hepatocellular tissue uptake rate     0.090413  mL/sec/mL    0.000000       Khe      7      1        5
281        Biliary tissue excretion rate     0.004593  mL/sec/mL    0.000000       Kbh      7      1        5
282  Liver extracellular volume fraction     0.230000      mL/mL    0.000000        ve      7      2        5
283           Hepatocellular uptake rate     0.005198  mL/sec/mL    0.000558       khe      7      2        5
284          Hepatocellular transit time   411.646855        sec   54.772915        Th      7      2        5
285               Biliary excretion rate     0.001871  mL/sec/mL    0.000000       kbh      7      2        5
286    Hepatocellular tissue uptake rate     0.022601  mL/sec/mL    0.000000       Khe      7      2        5
287        Biliary tissue excretion rate     0.002429  mL/sec/mL    0.000000       Kbh      7      2        5
288  Liver extracellular volume fraction     0.230000      mL/mL    0.000000        ve      7      1        6
289           Hepatocellular uptake rate     0.022668  mL/sec/mL    0.002503       khe      7      1        6
290          Hepatocellular transit time   257.853793        sec   30.913491        Th      7      1        6
291               Biliary excretion rate     0.002986  mL/sec/mL    0.000000       kbh      7      1        6
292    Hepatocellular tissue uptake rate     0.098555  mL/sec/mL    0.000000       Khe      7      1        6
293        Biliary tissue excretion rate     0.003878  mL/sec/mL    0.000000       Kbh      7      1        6
294  Liver extracellular volume fraction     0.230000      mL/mL    0.000000        ve      7      2        6
295           Hepatocellular uptake rate     0.016663  mL/sec/mL    0.001340       khe      7      2        6
296          Hepatocellular transit time   279.886393        sec   25.039767        Th      7      2        6
297               Biliary excretion rate     0.002751  mL/sec/mL    0.000000       kbh      7      2        6
298    Hepatocellular tissue uptake rate     0.072447  mL/sec/mL    0.000000       Khe      7      2        6
299        Biliary tissue excretion rate     0.003573  mL/sec/mL    0.000000       Kbh      7      2        6
300  Liver extracellular volume fraction     0.230000      mL/mL    0.000000        ve      6      1        2
301           Hepatocellular uptake rate     0.029692  mL/sec/mL    0.001747       khe      6      1        2
302          Hepatocellular transit time   210.519665        sec   13.230801        Th      6      1        2
303               Biliary excretion rate     0.003658  mL/sec/mL    0.000000       kbh      6      1        2
304    Hepatocellular tissue uptake rate     0.129096  mL/sec/mL    0.000000       Khe      6      1        2
305        Biliary tissue excretion rate     0.004750  mL/sec/mL    0.000000       Kbh      6      1        2
306  Liver extracellular volume fraction     0.230000      mL/mL    0.000000        ve      6      2        2
307           Hepatocellular uptake rate     0.028013  mL/sec/mL    0.001194       khe      6      2        2
308          Hepatocellular transit time   251.245914        sec   11.607090        Th      6      2        2
309               Biliary excretion rate     0.003065  mL/sec/mL    0.000000       kbh      6      2        2
310    Hepatocellular tissue uptake rate     0.121797  mL/sec/mL    0.000000       Khe      6      2        2
311        Biliary tissue excretion rate     0.003980  mL/sec/mL    0.000000       Kbh      6      2        2
312  Liver extracellular volume fraction     0.230000      mL/mL    0.000000        ve      6      1        3
313           Hepatocellular uptake rate     0.025392  mL/sec/mL    0.002819       khe      6      1        3
314          Hepatocellular transit time   162.883214        sec   19.286168        Th      6      1        3
315               Biliary excretion rate     0.004727  mL/sec/mL    0.000000       kbh      6      1        3
316    Hepatocellular tissue uptake rate     0.110400  mL/sec/mL    0.000000       Khe      6      1        3
317        Biliary tissue excretion rate     0.006139  mL/sec/mL    0.000000       Kbh      6      1        3
318  Liver extracellular volume fraction     0.230000      mL/mL    0.000000        ve      6      2        3
319           Hepatocellular uptake rate     0.025035  mL/sec/mL    0.001318       khe      6      2        3
320          Hepatocellular transit time   219.712981        sec   12.493403        Th      6      2        3
321               Biliary excretion rate     0.003505  mL/sec/mL    0.000000       kbh      6      2        3
322    Hepatocellular tissue uptake rate     0.108849  mL/sec/mL    0.000000       Khe      6      2        3
323        Biliary tissue excretion rate     0.004551  mL/sec/mL    0.000000       Kbh      6      2        3
324  Liver extracellular volume fraction     0.230000      mL/mL    0.000000        ve      6      1        4
325           Hepatocellular uptake rate     0.020645  mL/sec/mL    0.001432       khe      6      1        4
326          Hepatocellular transit time   173.410972        sec   12.956188        Th      6      1        4
327               Biliary excretion rate     0.004440  mL/sec/mL    0.000000       kbh      6      1        4
328    Hepatocellular tissue uptake rate     0.089760  mL/sec/mL    0.000000       Khe      6      1        4
329        Biliary tissue excretion rate     0.005767  mL/sec/mL    0.000000       Kbh      6      1        4
330  Liver extracellular volume fraction     0.230000      mL/mL    0.000000        ve      6      2        4
331           Hepatocellular uptake rate     0.016584  mL/sec/mL    0.001558       khe      6      2        4
332          Hepatocellular transit time   202.543677        sec   20.792146        Th      6      2        4
333               Biliary excretion rate     0.003802  mL/sec/mL    0.000000       kbh      6      2        4
334    Hepatocellular tissue uptake rate     0.072106  mL/sec/mL    0.000000       Khe      6      2        4
335        Biliary tissue excretion rate     0.004937  mL/sec/mL    0.000000       Kbh      6      2        4
336  Liver extracellular volume fraction     0.230000      mL/mL    0.000000        ve      6      1        5
337           Hepatocellular uptake rate     0.019787  mL/sec/mL    0.001496       khe      6      1        5
338          Hepatocellular transit time   170.728711        sec   13.916344        Th      6      1        5
339               Biliary excretion rate     0.004510  mL/sec/mL    0.000000       kbh      6      1        5
340    Hepatocellular tissue uptake rate     0.086032  mL/sec/mL    0.000000       Khe      6      1        5
341        Biliary tissue excretion rate     0.005857  mL/sec/mL    0.000000       Kbh      6      1        5
342  Liver extracellular volume fraction     0.230000      mL/mL    0.000000        ve      6      2        5
343           Hepatocellular uptake rate     0.020136  mL/sec/mL    0.001049       khe      6      2        5
344          Hepatocellular transit time   241.438736        sec   13.798872        Th      6      2        5
345               Biliary excretion rate     0.003189  mL/sec/mL    0.000000       kbh      6      2        5
346    Hepatocellular tissue uptake rate     0.087548  mL/sec/mL    0.000000       Khe      6      2        5
347        Biliary tissue excretion rate     0.004142  mL/sec/mL    0.000000       Kbh      6      2        5
348  Liver extracellular volume fraction     0.230000      mL/mL    0.000000        ve      6      1        6
349           Hepatocellular uptake rate     0.020815  mL/sec/mL    0.001521       khe      6      1        6
350          Hepatocellular transit time   231.679353        sec   18.493126        Th      6      1        6
351               Biliary excretion rate     0.003324  mL/sec/mL    0.000000       kbh      6      1        6
352    Hepatocellular tissue uptake rate     0.090501  mL/sec/mL    0.000000       Khe      6      1        6
353        Biliary tissue excretion rate     0.004316  mL/sec/mL    0.000000       Kbh      6      1        6
354  Liver extracellular volume fraction     0.230000      mL/mL    0.000000        ve      6      2        6
355           Hepatocellular uptake rate     0.023018  mL/sec/mL    0.001233       khe      6      2        6
356          Hepatocellular transit time   234.544047        sec   13.682293        Th      6      2        6
357               Biliary excretion rate     0.003283  mL/sec/mL    0.000000       kbh      6      2        6
358    Hepatocellular tissue uptake rate     0.100079  mL/sec/mL    0.000000       Khe      6      2        6
359        Biliary tissue excretion rate     0.004264  mL/sec/mL    0.000000       Kbh      6      2        6
360  Liver extracellular volume fraction     0.230000      mL/mL    0.000000        ve     12      1        1
361           Hepatocellular uptake rate     0.030001  mL/sec/mL    0.001978       khe     12      1        1
362          Hepatocellular transit time   326.126020        sec   23.644688        Th     12      1        1
363               Biliary excretion rate     0.002361  mL/sec/mL    0.000000       kbh     12      1        1
364    Hepatocellular tissue uptake rate     0.130439  mL/sec/mL    0.000000       Khe     12      1        1
365        Biliary tissue excretion rate     0.003066  mL/sec/mL    0.000000       Kbh     12      1        1
366  Liver extracellular volume fraction     0.230000      mL/mL    0.000000        ve     12      2        1
367           Hepatocellular uptake rate     0.015165  mL/sec/mL    0.000934       khe     12      2        1
368          Hepatocellular transit time   457.097782        sec   35.076563        Th     12      2        1
369               Biliary excretion rate     0.001685  mL/sec/mL    0.000000       kbh     12      2        1
370    Hepatocellular tissue uptake rate     0.065934  mL/sec/mL    0.000000       Khe     12      2        1
371        Biliary tissue excretion rate     0.002188  mL/sec/mL    0.000000       Kbh     12      2        1
372  Liver extracellular volume fraction     0.230000      mL/mL    0.000000        ve     12      1        2
373           Hepatocellular uptake rate     0.027449  mL/sec/mL    0.001945       khe     12      1        2
374          Hepatocellular transit time   262.262759        sec   19.954769        Th     12      1        2
375               Biliary excretion rate     0.002936  mL/sec/mL    0.000000       kbh     12      1        2
376    Hepatocellular tissue uptake rate     0.119342  mL/sec/mL    0.000000       Khe     12      1        2
377        Biliary tissue excretion rate     0.003813  mL/sec/mL    0.000000       Kbh     12      1        2
378  Liver extracellular volume fraction     0.230000      mL/mL    0.000000        ve     12      2        2
379           Hepatocellular uptake rate     0.012937  mL/sec/mL    0.000522       khe     12      2        2
380          Hepatocellular transit time   490.433526        sec   25.461919        Th     12      2        2
381               Biliary excretion rate     0.001570  mL/sec/mL    0.000000       kbh     12      2        2
382    Hepatocellular tissue uptake rate     0.056246  mL/sec/mL    0.000000       Khe     12      2        2
383        Biliary tissue excretion rate     0.002039  mL/sec/mL    0.000000       Kbh     12      2        2
384  Liver extracellular volume fraction     0.230000      mL/mL    0.000000        ve     12      1        3
385           Hepatocellular uptake rate     0.030764  mL/sec/mL    0.002110       khe     12      1        3
386          Hepatocellular transit time   261.471442        sec   19.104723        Th     12      1        3
387               Biliary excretion rate     0.002945  mL/sec/mL    0.000000       kbh     12      1        3
388    Hepatocellular tissue uptake rate     0.133758  mL/sec/mL    0.000000       Khe     12      1        3
389        Biliary tissue excretion rate     0.003825  mL/sec/mL    0.000000       Kbh     12      1        3
390  Liver extracellular volume fraction     0.230000      mL/mL    0.000000        ve     12      2        3
391           Hepatocellular uptake rate     0.013389  mL/sec/mL    0.000744       khe     12      2        3
392          Hepatocellular transit time   445.094856        sec   30.691694        Th     12      2        3
393               Biliary excretion rate     0.001730  mL/sec/mL    0.000000       kbh     12      2        3
394    Hepatocellular tissue uptake rate     0.058215  mL/sec/mL    0.000000       Khe     12      2        3
395        Biliary tissue excretion rate     0.002247  mL/sec/mL    0.000000       Kbh     12      2        3
396  Liver extracellular volume fraction     0.230000      mL/mL    0.000000        ve     12      1        4
397           Hepatocellular uptake rate     0.028472  mL/sec/mL    0.001857       khe     12      1        4
398          Hepatocellular transit time   269.440216        sec   18.874485        Th     12      1        4
399               Biliary excretion rate     0.002858  mL/sec/mL    0.000000       kbh     12      1        4
400    Hepatocellular tissue uptake rate     0.123790  mL/sec/mL    0.000000       Khe     12      1        4
401        Biliary tissue excretion rate     0.003711  mL/sec/mL    0.000000       Kbh     12      1        4
402  Liver extracellular volume fraction     0.230000      mL/mL    0.000000        ve     12      2        4
403           Hepatocellular uptake rate     0.010417  mL/sec/mL    0.000508       khe     12      2        4
404          Hepatocellular transit time   587.782059        sec   40.035799        Th     12      2        4
405               Biliary excretion rate     0.001310  mL/sec/mL    0.000000       kbh     12      2        4
406    Hepatocellular tissue uptake rate     0.045290  mL/sec/mL    0.000000       Khe     12      2        4
407        Biliary tissue excretion rate     0.001701  mL/sec/mL    0.000000       Kbh     12      2        4
</pre></div>
</div>
</section>
<section id="plot-individual-results">
<h2>Plot individual results<a class="headerlink" href="#plot-individual-results" title="Link to this heading">#</a></h2>
<p>Now lets visualise the main results from the study by plotting the drug effect for all rats, and for both biomarkers: uptake rate <code class="docutils literal notranslate"><span class="pre">khe</span></code> and excretion rate <code class="docutils literal notranslate"><span class="pre">kbh</span></code>:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set up the figure</span>
<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">clr</span></a> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;tab:blue&#39;</span><span class="p">,</span> <span class="s1">&#39;tab:orange&#39;</span><span class="p">,</span> <span class="s1">&#39;tab:green&#39;</span><span class="p">,</span> <span class="s1">&#39;tab:red&#39;</span><span class="p">,</span> <span class="s1">&#39;tab:purple&#39;</span><span class="p">,</span> <span class="s1">&#39;tab:brown&#39;</span><span class="p">]</span>
<a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fs</span></a> <span class="o">=</span> <span class="mi">10</span>
<span class="n">fig</span><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax</span></a> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="o">*</span><span class="mf">1.5</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">wspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>

<span class="c1"># Loop over all studies</span>
<a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">studies</span></a> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">12</span><span class="p">]</span>
<a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">drugs</span></a> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Asunaprevir&#39;</span><span class="p">,</span><span class="s1">&#39;Bosentan&#39;</span><span class="p">,</span><span class="s1">&#39;Cyclosporine&#39;</span><span class="p">,</span><span class="s1">&#39;Ketoconazole&#39;</span><span class="p">,</span><span class="s1">&#39;Pioglitazone&#39;</span><span class="p">,</span><span class="s1">&#39;Rifampicin&#39;</span><span class="p">]</span>
<span class="k">for</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">i</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">s</span></a> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">studies</span></a><span class="p">):</span>

    <span class="c1"># Set up subfigures for the study</span>
    <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax</span></a><span class="p">[</span><span class="mi">0</span><span class="p">,</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">i</span></a><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">drugs</span></a><span class="p">[</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">i</span></a><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fs</span></a><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax</span></a><span class="p">[</span><span class="mi">0</span><span class="p">,</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">i</span></a><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>
    <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax</span></a><span class="p">[</span><span class="mi">0</span><span class="p">,</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">i</span></a><span class="p">]</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([])</span>
    <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax</span></a><span class="p">[</span><span class="mi">1</span><span class="p">,</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">i</span></a><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
    <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax</span></a><span class="p">[</span><span class="mi">1</span><span class="p">,</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">i</span></a><span class="p">]</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([])</span>
    <span class="k">if</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">i</span></a><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
        <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax</span></a><span class="p">[</span><span class="mi">0</span><span class="p">,</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">i</span></a><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;khe (mL/min/100mL)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fs</span></a><span class="p">)</span>
        <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax</span></a><span class="p">[</span><span class="mi">0</span><span class="p">,</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">i</span></a><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fs</span></a><span class="p">)</span>
        <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax</span></a><span class="p">[</span><span class="mi">1</span><span class="p">,</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">i</span></a><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;kbh (mL/min/100mL)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fs</span></a><span class="p">)</span>
        <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax</span></a><span class="p">[</span><span class="mi">1</span><span class="p">,</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">i</span></a><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fs</span></a><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax</span></a><span class="p">[</span><span class="mi">0</span><span class="p">,</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">i</span></a><span class="p">]</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([])</span>
        <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax</span></a><span class="p">[</span><span class="mi">1</span><span class="p">,</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">i</span></a><span class="p">]</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([])</span>

    <span class="c1"># Pivot data for both visits of the study for easy access:</span>
    <span class="n">study</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="n">results</span><span class="o">.</span><span class="n">study</span><span class="o">==</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">s</span></a><span class="p">]</span>
    <span class="n">v1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">study</span><span class="p">[</span><span class="n">study</span><span class="o">.</span><span class="n">visit</span><span class="o">==</span><span class="mi">1</span><span class="p">],</span> <span class="n">values</span><span class="o">=</span><span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;parameter&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="s1">&#39;subject&#39;</span><span class="p">)</span>
    <span class="n">v2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">study</span><span class="p">[</span><span class="n">study</span><span class="o">.</span><span class="n">visit</span><span class="o">==</span><span class="mi">2</span><span class="p">],</span> <span class="n">values</span><span class="o">=</span><span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;parameter&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="s1">&#39;subject&#39;</span><span class="p">)</span>

    <span class="c1"># Plot the rate constants in units of mL/min/100mL</span>
    <span class="k">for</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">s</span></a> <span class="ow">in</span> <span class="n">v1</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
        <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">x</span></a> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">khe</span></a> <span class="o">=</span> <span class="p">[</span><span class="mi">6000</span><span class="o">*</span><span class="n">v1</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">s</span></a><span class="p">,</span><span class="s1">&#39;khe&#39;</span><span class="p">]]</span>
        <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">kbh</span></a> <span class="o">=</span> <span class="p">[</span><span class="mi">6000</span><span class="o">*</span><span class="n">v1</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">s</span></a><span class="p">,</span><span class="s1">&#39;kbh&#39;</span><span class="p">]]</span>
        <span class="k">if</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">s</span></a> <span class="ow">in</span> <span class="n">v2</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
            <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">x</span></a> <span class="o">+=</span> <span class="p">[</span><span class="mi">2</span><span class="p">]</span>
            <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">khe</span></a> <span class="o">+=</span> <span class="p">[</span><span class="mi">6000</span><span class="o">*</span><span class="n">v2</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">s</span></a><span class="p">,</span><span class="s1">&#39;khe&#39;</span><span class="p">]]</span>
            <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">kbh</span></a> <span class="o">+=</span> <span class="p">[</span><span class="mi">6000</span><span class="o">*</span><span class="n">v2</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">s</span></a><span class="p">,</span><span class="s1">&#39;kbh&#39;</span><span class="p">]]</span>
        <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">color</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">clr</span></a><span class="p">[</span><span class="nb">int</span><span class="p">(</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">s</span></a><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax</span></a><span class="p">[</span><span class="mi">0</span><span class="p">,</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">i</span></a><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">x</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">khe</span></a><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">s</span></a><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">color</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">color</span></a><span class="p">)</span>
        <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax</span></a><span class="p">[</span><span class="mi">1</span><span class="p">,</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">i</span></a><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">x</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">kbh</span></a><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">s</span></a><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">color</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">color</span></a><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img src="../../../_images/sphx_glr_plot_tristan6drugs_002.png" srcset="../../../_images/sphx_glr_plot_tristan6drugs_002.png" alt="Asunaprevir, Bosentan, Cyclosporine, Ketoconazole, Pioglitazone, Rifampicin" class = "sphx-glr-single-img"/></section>
<section id="plot-effect-sizes">
<h2>Plot effect sizes<a class="headerlink" href="#plot-effect-sizes" title="Link to this heading">#</a></h2>
<p>Now lets calculate the effect sizes (relative change) for each drug, along with 95% confidence interval, and show these in a plot. Results are presented in <strong>red</strong> if inhibition is more than 20% (i.e. upper value of the 95% CI is less than -20%), in <strong>orange</strong> if inhbition is less than 20% (i.e. upper value of the 95% CI is less than 0%), and in <strong>green</strong> if no inhibition was detected with 95% confidence (0% in the 95% CI):</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set up figure</span>
<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax0</span><span class="p">,</span> <span class="n">ax1</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span>

<span class="n">ax0</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;khe effect (%)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fs</span></a><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;kbh effect (%)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fs</span></a><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">ax0</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="n">ax0</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([])</span>

<span class="c1"># Loop over all studies</span>
<span class="k">for</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">i</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">s</span></a> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">studies</span></a><span class="p">):</span>

    <span class="c1"># Pivot data for both visits of the study for easy access:</span>
    <span class="n">study</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="n">results</span><span class="o">.</span><span class="n">study</span><span class="o">==</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">s</span></a><span class="p">]</span>
    <span class="n">v1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">study</span><span class="p">[</span><span class="n">study</span><span class="o">.</span><span class="n">visit</span><span class="o">==</span><span class="mi">1</span><span class="p">],</span> <span class="n">values</span><span class="o">=</span><span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;parameter&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="s1">&#39;subject&#39;</span><span class="p">)</span>
    <span class="n">v2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">study</span><span class="p">[</span><span class="n">study</span><span class="o">.</span><span class="n">visit</span><span class="o">==</span><span class="mi">2</span><span class="p">],</span> <span class="n">values</span><span class="o">=</span><span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;parameter&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="s1">&#39;subject&#39;</span><span class="p">)</span>

    <span class="c1"># Calculate effect size for the drug in %</span>
    <span class="n">effect</span> <span class="o">=</span> <span class="mi">100</span><span class="o">*</span><span class="p">(</span><span class="n">v2</span><span class="o">-</span><span class="n">v1</span><span class="p">)</span><span class="o">/</span><span class="n">v1</span>

    <span class="c1"># Get descriptive statistics</span>
    <span class="n">stats</span> <span class="o">=</span> <span class="n">effect</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>

    <span class="c1"># Calculate mean effect sizes and 59% CI on the mean.</span>
    <a href="https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64" title="numpy.float64" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-attribute"><span class="n">khe_eff</span></a> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span><span class="s1">&#39;khe&#39;</span><span class="p">]</span>
    <a href="https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64" title="numpy.float64" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-attribute"><span class="n">kbh_eff</span></a> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span><span class="s1">&#39;kbh&#39;</span><span class="p">]</span>
    <a href="https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64" title="numpy.float64" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-attribute"><span class="n">khe_eff_err</span></a> <span class="o">=</span> <span class="mf">1.96</span><span class="o">*</span><span class="n">stats</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="s1">&#39;std&#39;</span><span class="p">,</span><span class="s1">&#39;khe&#39;</span><span class="p">]</span><span class="o">/</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ufunc.html#numpy.ufunc" title="numpy.ufunc" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span></a><span class="p">(</span><span class="n">stats</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="s1">&#39;count&#39;</span><span class="p">,</span><span class="s1">&#39;khe&#39;</span><span class="p">])</span>
    <a href="https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64" title="numpy.float64" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-attribute"><span class="n">kbh_eff_err</span></a> <span class="o">=</span> <span class="mf">1.96</span><span class="o">*</span><span class="n">stats</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="s1">&#39;std&#39;</span><span class="p">,</span><span class="s1">&#39;kbh&#39;</span><span class="p">]</span><span class="o">/</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ufunc.html#numpy.ufunc" title="numpy.ufunc" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span></a><span class="p">(</span><span class="n">stats</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="s1">&#39;count&#39;</span><span class="p">,</span><span class="s1">&#39;kbh&#39;</span><span class="p">])</span>

    <span class="c1"># Plot mean effect size for khe along with 95% CI</span>
    <span class="c1"># Choose color based on magnitude of effect</span>
    <span class="k">if</span> <a href="https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64" title="numpy.float64" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-attribute"><span class="n">khe_eff</span></a> <span class="o">+</span> <a href="https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64" title="numpy.float64" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-attribute"><span class="n">khe_eff_err</span></a> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">20</span><span class="p">:</span>
        <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">clr</span></a> <span class="o">=</span> <span class="s1">&#39;tab:red&#39;</span>
    <span class="k">elif</span> <a href="https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64" title="numpy.float64" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-attribute"><span class="n">khe_eff</span></a> <span class="o">+</span> <a href="https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64" title="numpy.float64" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-attribute"><span class="n">khe_eff_err</span></a> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">clr</span></a> <span class="o">=</span> <span class="s1">&#39;tab:orange&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">clr</span></a> <span class="o">=</span> <span class="s1">&#39;tab:green&#39;</span>
    <span class="n">ax0</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64" title="numpy.float64" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-attribute"><span class="n">khe_eff</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">drugs</span></a><span class="p">[</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">i</span></a><span class="p">],</span> <span class="n">xerr</span><span class="o">=</span><a href="https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64" title="numpy.float64" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-attribute"><span class="n">khe_eff_err</span></a><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">color</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">clr</span></a><span class="p">)</span>

    <span class="c1"># Plot mean effect size for kbh along with 95% CI</span>
    <span class="c1"># Choose color based on magnitude of effect</span>
    <span class="k">if</span> <a href="https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64" title="numpy.float64" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-attribute"><span class="n">kbh_eff</span></a> <span class="o">+</span> <a href="https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64" title="numpy.float64" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-attribute"><span class="n">kbh_eff_err</span></a> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">20</span><span class="p">:</span>
        <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">clr</span></a> <span class="o">=</span> <span class="s1">&#39;tab:red&#39;</span>
    <span class="k">elif</span> <a href="https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64" title="numpy.float64" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-attribute"><span class="n">kbh_eff</span></a> <span class="o">+</span> <a href="https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64" title="numpy.float64" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-attribute"><span class="n">kbh_eff_err</span></a> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">clr</span></a> <span class="o">=</span> <span class="s1">&#39;tab:orange&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">clr</span></a> <span class="o">=</span> <span class="s1">&#39;tab:green&#39;</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64" title="numpy.float64" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-attribute"><span class="n">kbh_eff</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">drugs</span></a><span class="p">[</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">i</span></a><span class="p">],</span> <span class="n">xerr</span><span class="o">=</span><a href="https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64" title="numpy.float64" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-attribute"><span class="n">kbh_eff_err</span></a><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">color</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">clr</span></a><span class="p">)</span>

<span class="c1"># Plot dummy values out of range to show a legend</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="o">-</span><span class="mi">200</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">drugs</span></a><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">color</span></a><span class="o">=</span><span class="s1">&#39;tab:red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;inhibition &gt; 20%&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="o">-</span><span class="mi">200</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">drugs</span></a><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">color</span></a><span class="o">=</span><span class="s1">&#39;tab:orange&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;inhibition&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="o">-</span><span class="mi">200</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">drugs</span></a><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">color</span></a><span class="o">=</span><span class="s1">&#39;tab:green&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;no inhibition&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;center left&#39;</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Choose the last image as a thumbnail for the gallery</span>
<span class="c1"># sphinx_gallery_thumbnail_number = -1</span>
</pre></div>
</div>
<img src="../../../_images/sphx_glr_plot_tristan6drugs_003.png" srcset="../../../_images/sphx_glr_plot_tristan6drugs_003.png" alt="khe effect (%), kbh effect (%)" class = "sphx-glr-single-img"/><p class="sphx-glr-timing"><strong>Total running time of the script:</strong> (0 minutes 8.352 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-generated-examples-use-cases-plot-tristan6drugs-py">
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../../_downloads/ed3f8c62a7057d173e58871aca91e1af/plot_tristan6drugs.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_tristan6drugs.ipynb</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../../_downloads/afbaa29ea23d5da483183bcd1896edfe/plot_tristan6drugs.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_tristan6drugs.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-zip docutils container">
<p><a class="reference download internal" download="" href="../../../_downloads/6cf47386b002edc0c630ea44b9f505a1/plot_tristan6drugs.zip"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">zipped:</span> <span class="pre">plot_tristan6drugs.zip</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="plot_tristan_volunteers_2scan.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">The TRISTAN experimental medicine study (2 scan protocol)</p>
      </div>
    </a>
    <a class="right-next"
       href="../../../contribute/index.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Contribute</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#setup">Setup</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#model-definition">Model definition</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#check-model-fit">Check model fit</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fit-all-data">Fit all data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-individual-results">Plot individual results</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-effect-sizes">Plot effect sizes</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">

  <div class="tocsection sourcelink">
    <a href="../../../_sources/generated/examples/use_cases/plot_tristan6drugs.rst.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2024, dcmri maintainers.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.0.2.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.15.4.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>